#include "proxychains.h"
#include <QFile>
#include <QTextStream>
#include <QDebug>
#include <ctime>

ProxyChains::ProxyChains(const QString& proxyFilePath) : currentProxyIndex(0) {
    QFile file(proxyFilePath);
    if (!file.open(QIODevice::ReadOnly | QIODevice::Text)) {
        qWarning() << "Failed to open proxy file:" << proxyFilePath;
        return;
    }

    QTextStream in(&file);
    while (!in.atEnd()) {
        QString line = in.readLine().trimmed();
        if (!line.isEmpty()) {
            proxies.push_back(line);
        }
    }
    file.close();

   
    std::srand(static_cast<unsigned>(std::time(nullptr)));
}

QString ProxyChains::getNextProxy() {
    if (proxies.empty()) {
        return QString();
    }

  
    currentProxyIndex = std::rand() % proxies.size();
    return proxies[currentProxyIndex];
}
