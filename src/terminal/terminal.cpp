#include "terminal.h"
#include <QVBoxLayout>

Terminal::Terminal(QWidget *parent)
    : QWidget(parent),
      outputArea(new QTextEdit(this)),
      process(new QProcess(this)) {
    QVBoxLayout *layout = new QVBoxLayout(this);
    layout->addWidget(outputArea);
    setLayout(layout);

   
    connect(process, &QProcess::readyReadStandardOutput, [this]() {
        outputArea->append(process->readAllStandardOutput());
    });
    connect(process, &QProcess::readyReadStandardError, [this]() {
        outputArea->append(process->readAllStandardError());
    });
    connect(process, QOverload<int, QProcess::ExitStatus>::of(&QProcess::finished), [this](int exitCode, QProcess::ExitStatus exitStatus) {
        outputArea->append(QString("Process finished with exit code %1 and status %2").arg(exitCode).arg(exitStatus));
    });
}

Terminal::~Terminal() {
    delete process;
    delete outputArea;
}

void Terminal::executePythonScript(const QString &scriptPath) {
    if (!scriptPath.endsWith(".py")) {
        outputArea->append("Error: Not a Python script.");
        return;
    }

   
    process->start("python3", QStringList() << scriptPath);
}
